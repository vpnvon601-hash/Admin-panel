<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Panel Admin Simple</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    padding: 20px;
  }
  .item {
    background: #1b1b1b;
    padding: 12px;
    border-radius: 8px;
    margin-bottom: 10px;
    border: 1px solid #333;
  }
  .btn-delete {
    background: #e14d4d;
    border: none;
    padding: 8px 12px;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 10px;
  }
</style>
</head>
<body>

<h2>Lista de citas</h2>
<p>(Lectura directa de Firebase Realtime Database)</p>

<div id="lista"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAN8piM_UR3kLDUnJFYe5diazItfvYIlSA",
    authDomain: "lazonadelbarbero-b4e75.firebaseapp.com",
    databaseURL: "https://lazonadelbarbero-b4e75-default-rtdb.firebaseio.com",
    projectId: "lazonadelbarbero-b4e75",
    storageBucket: "lazonadelbarbero-b4e75.firebasestorage.app",
    messagingSenderId: "251180096928",
    appId: "1:251180096928:web:86d0ab83c7e444af79d8c5",
    measurementId: "G-G4YL7M4Z00"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const lista = document.getElementById("lista");

  function cargarCitas() {
    const refCitas = ref(db, "appointments");

    onValue(refCitas, snap => {
      lista.innerHTML = "";

      const data = snap.val();
      if (!data) {
        lista.innerHTML = "<p>No hay citas guardadas.</p>";
        return;
      }

      for (const barbero in data) {
        for (const fecha in data[barbero]) {
          for (const id in data[barbero][fecha]) {

            const c = data[barbero][fecha][id];

            const div = document.createElement("div");
            div.className = "item";

            div.innerHTML = `
              <strong>${c.nombre || "Sin nombre"}</strong><br>
              Barbero: ${barbero}<br>
              Servicio: ${c.servicio}<br>
              Fecha: ${fecha}<br>
              Hora: ${c.startMinutes} min<br>
              Tel: ${c.telefono}<br>
              Email: ${c.email}<br>
              Precio: ${c.priceCOP}<br>
              Creado: ${c.createdAt}<br>
              <button class="btn-delete">Eliminar</button>
            `;

            // botón eliminar
            div.querySelector(".btn-delete").addEventListener("click", async () => {
              if (confirm("¿Eliminar esta cita?")) {
                await remove(ref(db, `appointments/${barbero}/${fecha}/${id}`));
              }
            });

            lista.appendChild(div);
          }
        }
      }
    });
  }

  cargarCitas();
</script>

</body>
</html>
